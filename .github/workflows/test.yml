name: Demo pipeline

on: [push]

jobs:
  deploy:
    name: Test
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Install xdotool
        run: sudo apt-get install xdotool
      - name: Install Slack CLI
        run: curl -fsSL https://downloads.slack-edge.com/slack-cli/install-dev.sh | bash
      - name: Check slack cli version
        run: slack-dev --version
      - name: Try Slack CLI login
        env:
          SUPER_SECRET: ${{ secrets.SLACK_TOKEN }}
        run: slack-dev login --auth $SUPER_SECRET
      - name: Create an App from template for Demo purpose
        run: slack-dev create my-app -t slack-samples/deno-hello-world
      - name: Start Slack CLI commands with the newly created app
        run: cd my-app && ls -l
      - name: Start Slack CLI commands to install the app
        run: cd my-app && slack-dev install --token ${{ secrets.SLACK_TOKEN }}
      - name: Start Slack CLI commands to list the app and workspace
        run: cd my-app && slack-dev workspace list --token ${{ secrets.SLACK_TOKEN }}
      - name: Create a trigger
        run: cd my-app && slack-dev trigger create --token ${{ secrets.SLACK_TOKEN }} --app deployed --trigger-def triggers/greeting_trigger.ts
      # - name: Start Slack CLI commands to list the triggers
      #   run: cd my-app && slack-dev trigger list --token $SUPER_SECRET --app deployed
      # - name: Finish Slack CLI commands to delete the app
      #   run: cd my-app && slack-dev delete --token $SLACK_USER_TOKEN --app deployed --force
      
      
